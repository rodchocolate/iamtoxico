<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>toxico â€” collection</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Space Grotesk', sans-serif;
    color: #fff;
    background: #0b0b0b url('bg-graffiti-10.jpg') center center / cover no-repeat fixed;
    min-height: 100vh;
  }

  /* dark overlay so text pops on busy bg */
  body::before {
    content: '';
    position: fixed; inset: 0;
    background: rgba(0,0,0,.55);
    z-index: 0;
  }

  header, main, footer { position: relative; z-index: 1; }

  /* ---- header ---- */
  header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 1.2rem 2rem;
    background: rgba(0,0,0,.45);
    backdrop-filter: blur(8px);
    border-bottom: 1px solid rgba(255,255,255,.08);
  }
  header .logo {
    font-size: 1.5rem; font-weight: 600;
    letter-spacing: .08em; text-transform: lowercase;
  }
  header nav a {
    color: rgba(255,255,255,.7); text-decoration: none;
    margin-left: 1.4rem; font-size: .95rem;
    transition: color .2s;
  }
  header nav a:hover { color: #fff; }

  /* ---- product grid ---- */
  main { padding: 2.5rem 2rem 4rem; max-width: 1280px; margin: 0 auto; }

  h1 {
    font-size: 2rem; font-weight: 600; margin-bottom: .3rem;
    letter-spacing: .04em; text-transform: lowercase;
  }
  .subtitle {
    color: rgba(255,255,255,.5); font-size: .95rem; margin-bottom: 2rem;
  }

  #product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1.6rem;
  }

  .product-card {
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.1);
    border-radius: 12px;
    overflow: hidden;
    transition: transform .25s, border-color .25s;
    cursor: pointer;
  }
  .product-card:hover {
    transform: translateY(-4px);
    border-color: rgba(255,255,255,.25);
  }
  .product-card img {
    width: 100%; aspect-ratio: 1; object-fit: cover;
    background: #1a1a1a;
  }
  .product-card .info {
    padding: 1rem 1.1rem;
  }
  .product-card .title {
    font-size: 1rem; font-weight: 600;
    margin-bottom: .35rem;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .product-card .price {
    font-size: .95rem; color: rgba(255,255,255,.55);
  }
  .product-card .btn {
    display: inline-block; margin-top: .7rem;
    padding: .45rem 1.1rem; font-size: .85rem;
    background: #fff; color: #000; border: none; border-radius: 6px;
    font-family: inherit; font-weight: 600; cursor: pointer;
    transition: background .2s;
  }
  .product-card .btn:hover { background: #e0e0e0; }

  /* loading / empty states */
  #loading, #empty {
    text-align: center; padding: 4rem 1rem;
    color: rgba(255,255,255,.5); font-size: 1.05rem;
  }
  .spinner {
    width: 36px; height: 36px; margin: 0 auto 1rem;
    border: 3px solid rgba(255,255,255,.15);
    border-top-color: #fff;
    border-radius: 50%;
    animation: spin .7s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* footer */
  footer {
    text-align: center; padding: 2rem;
    color: rgba(255,255,255,.3); font-size: .8rem;
  }

  @media (max-width: 600px) {
    header { padding: 1rem; }
    main { padding: 1.5rem 1rem 3rem; }
    #product-grid { grid-template-columns: 1fr 1fr; gap: 1rem; }
    .product-card .info { padding: .7rem .8rem; }
  }
</style>
</head>
<body>

<header>
  <div class="logo">toxico</div>
  <nav>
    <a href="/">valet</a>
    <a href="/shop.html">shop</a>
    <a href="/collection.html" style="color:#fff;">collection</a>
  </nav>
</header>

<main>
  <h1>all products</h1>
  <p class="subtitle" id="count"></p>

  <div id="loading">
    <div class="spinner"></div>
    loading collection&hellip;
  </div>

  <div id="empty" style="display:none;">no products found.</div>

  <div id="product-grid"></div>
</main>

<footer>&copy; 2025 toxico &mdash; elevated loungewear for the sporting life</footer>

<script>
(function () {
  const CATALOG_URLS = ['/api/valet/catalog', 'data/catalog.json'];
  const grid     = document.getElementById('product-grid');
  const loading  = document.getElementById('loading');
  const empty    = document.getElementById('empty');
  const countEl  = document.getElementById('count');

  /* ---- try each catalog source in order ---- */
  function tryFetch(urls) {
    if (!urls.length) {
      loading.style.display = 'none';
      empty.textContent = 'could not load products.';
      empty.style.display = 'block';
      return;
    }
    fetch(urls[0])
      .then(r => { if (!r.ok) throw new Error(r.status); return r.json(); })
      .then(renderProducts)
      .catch(() => tryFetch(urls.slice(1)));
  }

  function renderProducts(data) {
      loading.style.display = 'none';

      const products = data.products || data.items || data || [];
      if (!Array.isArray(products) || products.length === 0) {
        empty.style.display = 'block';
        return;
      }

      countEl.textContent = products.length + ' items';

      products.forEach(p => {
        const card = document.createElement('div');
        card.className = 'product-card';

        /* best-effort image: try image, images[0], thumbnail */
        const img = p.image || (p.images && p.images[0]) || p.thumbnail || '';
        const title = p.title || p.name || 'Untitled';
        const price = p.price
          ? (typeof p.price === 'number' ? '$' + (p.price / 100).toFixed(2) : p.price)
          : '';
        const link  = p.url || p.handle ? ('/products/' + p.handle) : '#';

        card.innerHTML =
          (img ? '<img src="' + img + '" alt="' + title + '" loading="lazy">'
               : '<div style="width:100%;aspect-ratio:1;background:#1a1a1a;display:flex;align-items:center;justify-content:center;color:#555;font-size:.9rem;">no image</div>') +
          '<div class="info">' +
            '<div class="title">' + title + '</div>' +
            (price ? '<div class="price">' + price + '</div>' : '') +
            '<button class="btn" onclick="location.href=\'' + link + '\'">view</button>' +
          '</div>';

        grid.appendChild(card);
      });
  }

  tryFetch(CATALOG_URLS);
})();
</script>
</body>
</html>
